# 🎯 **Kubernetes Deployments with YAML**

---

### 🧩 **Title**

**Kubernetes Deployments with YAML**

### 📝 **Description**

**Learn to write and test Kubernetes Deployments with YAML**

---

## 🚀 **Step-01: Copy templates from ReplicaSet**

### 🧱 **Objective**

Copy templates from ReplicaSet and change the **kind** to `Deployment` 🧩

---

### 🪄 **Modifications Required**

| 🔧 Change              | 🧭 Description                                   |
| ---------------------- | ------------------------------------------------ |
| **kind**               | Change from `ReplicaSet` ➜ `Deployment`          |
| **Container Image**    | Update image version ➜ `3.0.0`                   |
| **Names**              | Replace all names with **Deployment** references |
| **Labels / Selectors** | Change all labels and selectors to **myapp3**    |

---

### 📄 **File Example:** `01-deployment-definition.yml`

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp3-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp3
  template:
    metadata:
      labels:
        app: myapp3
    spec:
      containers:
      - name: myapp3
        image: stacksimplify/kubenginx:3.0.0
        ports:
          - containerPort: 80
```

---

### ⚙️ **Commands**

```bash
# Change Directory
cd kube-manifests

# Create Deployment
kubectl apply -f 01-deployment-definition.yml

# Check Deployment, ReplicaSet & Pods
kubectl get deploy
kubectl get rs
kubectl get po
```

---

### 📊 **Expected Output**

| 🧩 Command           | 🧾 Output Example                                              |
| -------------------- | -------------------------------------------------------------- |
| `kubectl get deploy` | Shows Deployment `myapp3-deployment` with `3/3` ready replicas |
| `kubectl get rs`     | Automatically created ReplicaSet for Deployment                |
| `kubectl get po`     | 3 Pods running and managed by the ReplicaSet                   |

---

### 💡 **Deployment vs ReplicaSet**

| ⚙️ Feature          | 🧩 ReplicaSet          | 🚀 Deployment                   |
| ------------------- | ---------------------- | ------------------------------- |
| **Purpose**         | Ensures Pods run       | Manages ReplicaSets and updates |
| **Versioning**      | ❌ No revision tracking | ✅ Tracks rollout history        |
| **Rolling Updates** | ❌ Manual               | ✅ Automatic                     |
| **Rollback**        | ❌ Not available        | ✅ Available                     |
| **Command**         | `kubectl get rs`       | `kubectl get deploy`            |

---

### 🧭 **Visual Overview: Deployment Flow**

```text
+------------------------------------------+
|      Deployment: myapp3-deployment 🚀     |
|  Desired Replicas: 3                     |
+-----------------------+------------------+
                        |
                        v
               +-------------------+
               |  ReplicaSet 🧩     |
               |  auto-created by   |
               |  Deployment        |
               +-------------------+
                        |
      +---------+-------+-------+---------+
      |         |               |         |
      v         v               v         v
 [Pod-1]     [Pod-2]        [Pod-3]   (Running ✅)
```

---

### 🌐 **Create LoadBalancer Service**

#### 📄 **File Example:** `02-deployment-LoadBalancer-service.yml`

```yaml
apiVersion: v1
kind: Service
metadata:
  name: deployment-loadbalancer-service
spec:
  type: LoadBalancer
  selector:
    app: myapp3
  ports:
    - name: http
      port: 80
      targetPort: 80
```

---

### ⚙️ **Commands**

```bash
# Create LoadBalancer Service
kubectl apply -f 02-deployment-LoadBalancer-service.yml

# List Service
kubectl get svc

# Get Public IP
kubectl get nodes -o wide

# Access Application
http://<Load-Balancer-Service-IP>
```

---

### 🌍 **Service Overview Table**

| ⚙️ Field          | 📖 Description                                          |
| ----------------- | ------------------------------------------------------- |
| **type**          | Exposes Pods externally via `LoadBalancer`              |
| **selector**      | Matches Pods labeled `app: myapp3`                      |
| **port**          | Port exposed on the service (80)                        |
| **targetPort**    | Port exposed inside the container (80)                  |
| **metadata.name** | Name of the service (`deployment-loadbalancer-service`) |

---

### 🌈 **Visual Flow: Deployment + Service**

```text
+---------------------------------------------+
| LoadBalancer Service 🌐 (Port: 80)          |
| Name: deployment-loadbalancer-service       |
+----------------------+----------------------+
                       |
                       v
             +-------------------------+
             | Deployment: myapp3-deployment |
             | Replicas: 3               |
             +-----------+---------------+
                         |
       +-----------+-----+-----+-----------+
       |           |           |           |
       v           v           v           v
   [Pod-1]     [Pod-2]     [Pod-3]     (Scalable)
```

---

## 🧹 **Step-02: Clean-Up Kubernetes Deployment and Service**

### ⚙️ **Commands**

```bash
# Change Directory
cd kube-manifests

# Delete Deployment
kubectl delete -f 01-deployment-definition.yml

# Delete LoadBalancer Service
kubectl delete -f 02-deployment-LoadBalancer-service.yml
```

---

### ✅ **Clean-Up Verification**

| 🔍 Resource    | 🧾 Command           | 🧹 Expected Result           |
| -------------- | -------------------- | ---------------------------- |
| **Deployment** | `kubectl get deploy` | Deleted successfully         |
| **ReplicaSet** | `kubectl get rs`     | Removed automatically        |
| **Pods**       | `kubectl get po`     | No Pods remaining            |
| **Service**    | `kubectl get svc`    | LoadBalancer Service removed |

---

## 📚 **API References**

| 🔗 Reference   | 🧭 Purpose                                                |
| -------------- | --------------------------------------------------------- |
| **Deployment** | Learn more about Deployment object structure and features |

---

### 🎓 **Summary Diagram: Complete Workflow**

```text
[01-deployment-definition.yml] --> Creates --> Deployment (myapp3-deployment)
                                   |
                                   v
                             ReplicaSet auto-created 🧩
                                   |
                                   v
                             3 Running Pods 🧱
                                   |
                                   v
[02-deployment-LoadBalancer-service.yml] --> Exposes --> Service (deployment-loadbalancer-service)
                                   |
                                   v
                             External Access 🌐
```

---

### 🏁 **End of SOP**

✅ You have successfully:

* Created a **Kubernetes Deployment** using YAML 🚀
* Verified ReplicaSet and Pod creation automatically 🔁
* Exposed your app via a **LoadBalancer Service** 🌐
* Cleaned up all resources neatly 🧹

---
