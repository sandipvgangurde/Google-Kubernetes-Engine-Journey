# ğŸ¯ **Kubernetes Deployments with YAML**

---

### ğŸ§© **Title**

**Kubernetes Deployments with YAML**

### ğŸ“ **Description**

**Learn to write and test Kubernetes Deployments with YAML**

---

## ğŸš€ **Step-01: Copy templates from ReplicaSet**

### ğŸ§± **Objective**

Copy templates from ReplicaSet and change the **kind** to `Deployment` ğŸ§©

---

### ğŸª„ **Modifications Required**

| ğŸ”§ Change              | ğŸ§­ Description                                   |
| ---------------------- | ------------------------------------------------ |
| **kind**               | Change from `ReplicaSet` âœ `Deployment`          |
| **Container Image**    | Update image version âœ `3.0.0`                   |
| **Names**              | Replace all names with **Deployment** references |
| **Labels / Selectors** | Change all labels and selectors to **myapp3**    |

---

### ğŸ“„ **File Example:** `01-deployment-definition.yml`

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp3-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp3
  template:
    metadata:
      labels:
        app: myapp3
    spec:
      containers:
      - name: myapp3
        image: stacksimplify/kubenginx:3.0.0
        ports:
          - containerPort: 80
```

---

### âš™ï¸ **Commands**

```bash
# Change Directory
cd kube-manifests

# Create Deployment
kubectl apply -f 01-deployment-definition.yml

# Check Deployment, ReplicaSet & Pods
kubectl get deploy
kubectl get rs
kubectl get po
```

---

### ğŸ“Š **Expected Output**

| ğŸ§© Command           | ğŸ§¾ Output Example                                              |
| -------------------- | -------------------------------------------------------------- |
| `kubectl get deploy` | Shows Deployment `myapp3-deployment` with `3/3` ready replicas |
| `kubectl get rs`     | Automatically created ReplicaSet for Deployment                |
| `kubectl get po`     | 3 Pods running and managed by the ReplicaSet                   |

---

### ğŸ’¡ **Deployment vs ReplicaSet**

| âš™ï¸ Feature          | ğŸ§© ReplicaSet          | ğŸš€ Deployment                   |
| ------------------- | ---------------------- | ------------------------------- |
| **Purpose**         | Ensures Pods run       | Manages ReplicaSets and updates |
| **Versioning**      | âŒ No revision tracking | âœ… Tracks rollout history        |
| **Rolling Updates** | âŒ Manual               | âœ… Automatic                     |
| **Rollback**        | âŒ Not available        | âœ… Available                     |
| **Command**         | `kubectl get rs`       | `kubectl get deploy`            |

---

### ğŸ§­ **Visual Overview: Deployment Flow**

```text
+------------------------------------------+
|      Deployment: myapp3-deployment ğŸš€     |
|  Desired Replicas: 3                     |
+-----------------------+------------------+
                        |
                        v
               +-------------------+
               |  ReplicaSet ğŸ§©     |
               |  auto-created by   |
               |  Deployment        |
               +-------------------+
                        |
      +---------+-------+-------+---------+
      |         |               |         |
      v         v               v         v
 [Pod-1]     [Pod-2]        [Pod-3]   (Running âœ…)
```

---

### ğŸŒ **Create LoadBalancer Service**

#### ğŸ“„ **File Example:** `02-deployment-LoadBalancer-service.yml`

```yaml
apiVersion: v1
kind: Service
metadata:
  name: deployment-loadbalancer-service
spec:
  type: LoadBalancer
  selector:
    app: myapp3
  ports:
    - name: http
      port: 80
      targetPort: 80
```

---

### âš™ï¸ **Commands**

```bash
# Create LoadBalancer Service
kubectl apply -f 02-deployment-LoadBalancer-service.yml

# List Service
kubectl get svc

# Get Public IP
kubectl get nodes -o wide

# Access Application
http://<Load-Balancer-Service-IP>
```

---

### ğŸŒ **Service Overview Table**

| âš™ï¸ Field          | ğŸ“– Description                                          |
| ----------------- | ------------------------------------------------------- |
| **type**          | Exposes Pods externally via `LoadBalancer`              |
| **selector**      | Matches Pods labeled `app: myapp3`                      |
| **port**          | Port exposed on the service (80)                        |
| **targetPort**    | Port exposed inside the container (80)                  |
| **metadata.name** | Name of the service (`deployment-loadbalancer-service`) |

---

### ğŸŒˆ **Visual Flow: Deployment + Service**

```text
+---------------------------------------------+
| LoadBalancer Service ğŸŒ (Port: 80)          |
| Name: deployment-loadbalancer-service       |
+----------------------+----------------------+
                       |
                       v
             +-------------------------+
             | Deployment: myapp3-deployment |
             | Replicas: 3               |
             +-----------+---------------+
                         |
       +-----------+-----+-----+-----------+
       |           |           |           |
       v           v           v           v
   [Pod-1]     [Pod-2]     [Pod-3]     (Scalable)
```

---

## ğŸ§¹ **Step-02: Clean-Up Kubernetes Deployment and Service**

### âš™ï¸ **Commands**

```bash
# Change Directory
cd kube-manifests

# Delete Deployment
kubectl delete -f 01-deployment-definition.yml

# Delete LoadBalancer Service
kubectl delete -f 02-deployment-LoadBalancer-service.yml
```

---

### âœ… **Clean-Up Verification**

| ğŸ” Resource    | ğŸ§¾ Command           | ğŸ§¹ Expected Result           |
| -------------- | -------------------- | ---------------------------- |
| **Deployment** | `kubectl get deploy` | Deleted successfully         |
| **ReplicaSet** | `kubectl get rs`     | Removed automatically        |
| **Pods**       | `kubectl get po`     | No Pods remaining            |
| **Service**    | `kubectl get svc`    | LoadBalancer Service removed |

---

## ğŸ“š **API References**

| ğŸ”— Reference   | ğŸ§­ Purpose                                                |
| -------------- | --------------------------------------------------------- |
| **Deployment** | Learn more about Deployment object structure and features |

---

### ğŸ“ **Summary Diagram: Complete Workflow**

```text
[01-deployment-definition.yml] --> Creates --> Deployment (myapp3-deployment)
                                   |
                                   v
                             ReplicaSet auto-created ğŸ§©
                                   |
                                   v
                             3 Running Pods ğŸ§±
                                   |
                                   v
[02-deployment-LoadBalancer-service.yml] --> Exposes --> Service (deployment-loadbalancer-service)
                                   |
                                   v
                             External Access ğŸŒ
```

---

### ğŸ **End of SOP**

âœ… You have successfully:

* Created a **Kubernetes Deployment** using YAML ğŸš€
* Verified ReplicaSet and Pod creation automatically ğŸ”
* Exposed your app via a **LoadBalancer Service** ğŸŒ
* Cleaned up all resources neatly ğŸ§¹

---
