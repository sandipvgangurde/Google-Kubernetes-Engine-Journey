# 🎯 **Kubernetes Services with YAML**

---

### 🧩 **Title**

**Kubernetes Services with YAML**

### 📝 **Description**

**Learn to write and test Kubernetes Services with YAML**

---

## 🚀 **Step-01: Introduction to Services**

### 🧠 **Overview**

We are going to look into the following two services in detail with a **frontend and backend** example:

| ⚙️ Service Type          | 🌐 Description                                                  |
| ------------------------ | --------------------------------------------------------------- |
| **LoadBalancer Service** | Exposes applications externally outside the Kubernetes cluster. |
| **ClusterIP Service**    | Exposes applications internally within the Kubernetes cluster.  |

---

### 🌈 **Visual Overview: Service Types**

```text
+--------------------------+        +-------------------------+
|  External User 🌍        |        |  Internal Pods 🧩        |
|  Access via Internet     |        |  Communicate internally  |
|      (LoadBalancer)      |        |     (ClusterIP)          |
+-------------+------------+        +-------------+-----------+
              |                                     |
              v                                     v
         [Frontend]                           [Backend]
```

---

## 🧱 **Step-02: Create Backend Deployment & Cluster IP Service**

### 🧩 **Objective**

* Write the Deployment template for **backend REST application**
* Write the **Cluster IP service** template for backend REST application

---

### ⚠️ **Important Notes**

* Name of Cluster IP service should be **`name: my-backend-service`** because the same is configured in frontend Nginx reverse proxy `default.conf`.
* Test with a different name and understand the issue we face 🧠
* We have also discussed this in **Section-12**.

---

### ⚙️ **Commands**

```bash
# Change Directory
cd kube-manifests

# Deploy Backend Kubernetes Deployment and ClusterIP Service 
kubectl get all
kubectl apply -f 01-backend-deployment.yml -f 02-backend-clusterip-service.yml
kubectl get all
```

---

### 📊 **Expected Backend Architecture**

```text
+-----------------------------------------------------+
|            Backend REST Application 🧩              |
+-----------------------------------------------------+
| Deployment: backend-deployment                      |
| Service: my-backend-service (ClusterIP)              |
| Port: 8080 (Internal Access Only)                    |
+-----------------------------------------------------+
```

---

### 🧱 **Backend Component Summary**

| 🔧 Component          | 🧾 Description                                          |
| --------------------- | ------------------------------------------------------- |
| **Deployment**        | Runs backend REST API Pods                              |
| **ClusterIP Service** | Provides internal communication for frontend to backend |
| **Service Name**      | Must be `my-backend-service`                            |
| **Connectivity**      | Frontend Nginx connects to this name inside cluster     |

---

## 🌐 **Step-03: Create Frontend Deployment & LoadBalancer Service**

### 🧩 **Objective**

* Write the Deployment template for **frontend Nginx Application**
* Write the **LoadBalancer Service** template for frontend Nginx Application

---

### ⚙️ **Commands**

```bash
# Change Directory
cd kube-manifests

# Deploy Frontend Kubernetes Deployment and LoadBalancer Service 
kubectl get all
kubectl apply -f 03-frontend-deployment.yml -f 04-frontend-LoadBalancer-service.yml
kubectl get all
```

---

### 🌎 **Access REST Application**

```bash
# Get Service IP
kubectl get svc

# Access REST Application 
http://<Load-Balancer-Service-IP>/hello
curl http://<Load-Balancer-Service-IP>/hello
```

---

### 🌈 **Visual Flow: Frontend ↔ Backend Communication**

```text
                🌐 LoadBalancer Service (Frontend)
                        |
                        v
                +----------------+
                | Frontend Pods  |
                | (Nginx App)    |
                +----------------+
                        |
            Internal DNS Service (ClusterIP)
                        |
                        v
                +----------------+
                | Backend Pods   |
                | REST API       |
                +----------------+
```

---

### 📘 **Frontend and Backend Integration Table**

| 🧩 Component            | 🔗 Connection Type               | 🌍 Access                            |
| ----------------------- | -------------------------------- | ------------------------------------ |
| **Frontend Service**    | LoadBalancer                     | External                             |
| **Frontend Deployment** | Nginx container                  | Connects to backend via internal DNS |
| **Backend Service**     | ClusterIP (`my-backend-service`) | Internal                             |
| **Backend Deployment**  | REST API server                  | Provides `/hello` endpoint           |

---

## 🔁 **Step-04: Delete & Recreate Objects using kubectl apply**

### 🧹 **Delete Objects (file by file)**

```bash
# Change Directory 
cd kube-manifests/

# Delete Objects File by file
kubectl delete -f 01-backend-deployment.yml -f 02-backend-clusterip-service.yml -f 03-frontend-deployment.yml -f 04-frontend-LoadBalancer-service.yml
kubectl get all
```

---

### 🧱 **Recreate Objects using YAML files in a folder**

```bash
# Change Directory 
cd 17-yaml-declarative-k8s-services/

# Recreate Objects by referencing a folder
kubectl apply -f kube-manifests/
kubectl get all
```

---

### 🧹 **Delete Objects using YAML files in folder**

```bash
# Change Directory 
cd 17-yaml-declarative-k8s-services/

# Delete Objects by just referencing a folder
kubectl delete -f kube-manifests/
kubectl get all
```

---

### 📊 **Command Summary Table**

| 🧭 Action              | 🧱 Command                                                                            | 🧾 Description                                        |
| ---------------------- | ------------------------------------------------------------------------------------- | ----------------------------------------------------- |
| **Deploy Backend**     | `kubectl apply -f 01-backend-deployment.yml -f 02-backend-clusterip-service.yml`      | Creates backend REST app & internal ClusterIP service |
| **Deploy Frontend**    | `kubectl apply -f 03-frontend-deployment.yml -f 04-frontend-LoadBalancer-service.yml` | Creates frontend Nginx & external LoadBalancer        |
| **Delete Resources**   | `kubectl delete -f kube-manifests/`                                                   | Cleans up all created objects                         |
| **Recreate Resources** | `kubectl apply -f kube-manifests/`                                                    | Redeploys all services and deployments                |

---

## 📚 **Additional References**

| 🔗 Reference         | 🧭 Purpose                                             |
| -------------------- | ------------------------------------------------------ |
| **Labels**           | Helps organize, filter, and manage Kubernetes objects  |
| **Labels-Selectors** | Used to select groups of Pods or resources efficiently |

---

### 🎓 **Summary Diagram: Complete Service Flow**

```text
             +----------------------------------------+
             | LoadBalancer Service (Frontend) 🌐      |
             | Port 80 → Frontend Pods (Nginx)         |
             +--------------------+--------------------+
                                  |
                                  v
                        [Frontend Pods]
                                  |
                   Access Internal DNS ➜ my-backend-service
                                  |
                                  v
             +----------------------------------------+
             | ClusterIP Service (Backend) 🧩          |
             | Port 8080 → Backend REST API Pods       |
             +----------------------------------------+
```

---

### 🏁 **End of SOP**

✅ You have successfully:

* Understood **LoadBalancer** and **ClusterIP** Kubernetes Services 🌐
* Created **frontend and backend deployments** using YAML 🧩
* Verified service interconnectivity 🔁
* Practiced cleanup and re-deployment using folders 🧹

---
