# ğŸ¯ **Kubernetes Services with YAML**

---

### ğŸ§© **Title**

**Kubernetes Services with YAML**

### ğŸ“ **Description**

**Learn to write and test Kubernetes Services with YAML**

---

## ğŸš€ **Step-01: Introduction to Services**

### ğŸ§  **Overview**

We are going to look into the following two services in detail with a **frontend and backend** example:

| âš™ï¸ Service Type          | ğŸŒ Description                                                  |
| ------------------------ | --------------------------------------------------------------- |
| **LoadBalancer Service** | Exposes applications externally outside the Kubernetes cluster. |
| **ClusterIP Service**    | Exposes applications internally within the Kubernetes cluster.  |

---

### ğŸŒˆ **Visual Overview: Service Types**

```text
+--------------------------+        +-------------------------+
|  External User ğŸŒ        |        |  Internal Pods ğŸ§©        |
|  Access via Internet     |        |  Communicate internally  |
|      (LoadBalancer)      |        |     (ClusterIP)          |
+-------------+------------+        +-------------+-----------+
              |                                     |
              v                                     v
         [Frontend]                           [Backend]
```

---

## ğŸ§± **Step-02: Create Backend Deployment & Cluster IP Service**

### ğŸ§© **Objective**

* Write the Deployment template for **backend REST application**
* Write the **Cluster IP service** template for backend REST application

---

### âš ï¸ **Important Notes**

* Name of Cluster IP service should be **`name: my-backend-service`** because the same is configured in frontend Nginx reverse proxy `default.conf`.
* Test with a different name and understand the issue we face ğŸ§ 
* We have also discussed this in **Section-12**.

---

### âš™ï¸ **Commands**

```bash
# Change Directory
cd kube-manifests

# Deploy Backend Kubernetes Deployment and ClusterIP Service 
kubectl get all
kubectl apply -f 01-backend-deployment.yml -f 02-backend-clusterip-service.yml
kubectl get all
```

---

### ğŸ“Š **Expected Backend Architecture**

```text
+-----------------------------------------------------+
|            Backend REST Application ğŸ§©              |
+-----------------------------------------------------+
| Deployment: backend-deployment                      |
| Service: my-backend-service (ClusterIP)              |
| Port: 8080 (Internal Access Only)                    |
+-----------------------------------------------------+
```

---

### ğŸ§± **Backend Component Summary**

| ğŸ”§ Component          | ğŸ§¾ Description                                          |
| --------------------- | ------------------------------------------------------- |
| **Deployment**        | Runs backend REST API Pods                              |
| **ClusterIP Service** | Provides internal communication for frontend to backend |
| **Service Name**      | Must be `my-backend-service`                            |
| **Connectivity**      | Frontend Nginx connects to this name inside cluster     |

---

## ğŸŒ **Step-03: Create Frontend Deployment & LoadBalancer Service**

### ğŸ§© **Objective**

* Write the Deployment template for **frontend Nginx Application**
* Write the **LoadBalancer Service** template for frontend Nginx Application

---

### âš™ï¸ **Commands**

```bash
# Change Directory
cd kube-manifests

# Deploy Frontend Kubernetes Deployment and LoadBalancer Service 
kubectl get all
kubectl apply -f 03-frontend-deployment.yml -f 04-frontend-LoadBalancer-service.yml
kubectl get all
```

---

### ğŸŒ **Access REST Application**

```bash
# Get Service IP
kubectl get svc

# Access REST Application 
http://<Load-Balancer-Service-IP>/hello
curl http://<Load-Balancer-Service-IP>/hello
```

---

### ğŸŒˆ **Visual Flow: Frontend â†” Backend Communication**

```text
                ğŸŒ LoadBalancer Service (Frontend)
                        |
                        v
                +----------------+
                | Frontend Pods  |
                | (Nginx App)    |
                +----------------+
                        |
            Internal DNS Service (ClusterIP)
                        |
                        v
                +----------------+
                | Backend Pods   |
                | REST API       |
                +----------------+
```

---

### ğŸ“˜ **Frontend and Backend Integration Table**

| ğŸ§© Component            | ğŸ”— Connection Type               | ğŸŒ Access                            |
| ----------------------- | -------------------------------- | ------------------------------------ |
| **Frontend Service**    | LoadBalancer                     | External                             |
| **Frontend Deployment** | Nginx container                  | Connects to backend via internal DNS |
| **Backend Service**     | ClusterIP (`my-backend-service`) | Internal                             |
| **Backend Deployment**  | REST API server                  | Provides `/hello` endpoint           |

---

## ğŸ” **Step-04: Delete & Recreate Objects using kubectl apply**

### ğŸ§¹ **Delete Objects (file by file)**

```bash
# Change Directory 
cd kube-manifests/

# Delete Objects File by file
kubectl delete -f 01-backend-deployment.yml -f 02-backend-clusterip-service.yml -f 03-frontend-deployment.yml -f 04-frontend-LoadBalancer-service.yml
kubectl get all
```

---

### ğŸ§± **Recreate Objects using YAML files in a folder**

```bash
# Change Directory 
cd 17-yaml-declarative-k8s-services/

# Recreate Objects by referencing a folder
kubectl apply -f kube-manifests/
kubectl get all
```

---

### ğŸ§¹ **Delete Objects using YAML files in folder**

```bash
# Change Directory 
cd 17-yaml-declarative-k8s-services/

# Delete Objects by just referencing a folder
kubectl delete -f kube-manifests/
kubectl get all
```

---

### ğŸ“Š **Command Summary Table**

| ğŸ§­ Action              | ğŸ§± Command                                                                            | ğŸ§¾ Description                                        |
| ---------------------- | ------------------------------------------------------------------------------------- | ----------------------------------------------------- |
| **Deploy Backend**     | `kubectl apply -f 01-backend-deployment.yml -f 02-backend-clusterip-service.yml`      | Creates backend REST app & internal ClusterIP service |
| **Deploy Frontend**    | `kubectl apply -f 03-frontend-deployment.yml -f 04-frontend-LoadBalancer-service.yml` | Creates frontend Nginx & external LoadBalancer        |
| **Delete Resources**   | `kubectl delete -f kube-manifests/`                                                   | Cleans up all created objects                         |
| **Recreate Resources** | `kubectl apply -f kube-manifests/`                                                    | Redeploys all services and deployments                |

---

## ğŸ“š **Additional References**

| ğŸ”— Reference         | ğŸ§­ Purpose                                             |
| -------------------- | ------------------------------------------------------ |
| **Labels**           | Helps organize, filter, and manage Kubernetes objects  |
| **Labels-Selectors** | Used to select groups of Pods or resources efficiently |

---

### ğŸ“ **Summary Diagram: Complete Service Flow**

```text
             +----------------------------------------+
             | LoadBalancer Service (Frontend) ğŸŒ      |
             | Port 80 â†’ Frontend Pods (Nginx)         |
             +--------------------+--------------------+
                                  |
                                  v
                        [Frontend Pods]
                                  |
                   Access Internal DNS âœ my-backend-service
                                  |
                                  v
             +----------------------------------------+
             | ClusterIP Service (Backend) ğŸ§©          |
             | Port 8080 â†’ Backend REST API Pods       |
             +----------------------------------------+
```

---

### ğŸ **End of SOP**

âœ… You have successfully:

* Understood **LoadBalancer** and **ClusterIP** Kubernetes Services ğŸŒ
* Created **frontend and backend deployments** using YAML ğŸ§©
* Verified service interconnectivity ğŸ”
* Practiced cleanup and re-deployment using folders ğŸ§¹

---
